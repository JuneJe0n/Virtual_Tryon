You have video processor config saved in `preprocessor.json` file which is deprecated. Video processor configs should be saved in their own `video_preprocessor.json` file. You can rename the file or load and save the processor back which renames it automatically. Loading from `preprocessor.json` will be removed in v5.0.
Loading checkpoint shards: 100%|████████████████████████████████████| 2/2 [00:00<00:00,  2.08it/s]
trainable params: 1,843,200 || all params: 3,756,466,176 || trainable%: 0.0491
  0%|                                                                    | 0/4750 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/home/jiyoon/LViton_GRPO/train.py", line 128, in <module>
    trainer.train()
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/trainer.py", line 2238, in train
    return inner_training_loop(
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/trainer.py", line 2582, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/trainer.py", line 3790, in training_step
    inputs = self._prepare_inputs(inputs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/trl/extras/profiling.py", line 98, in wrapper
    return func(self, *args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/trl/trainer/grpo_trainer.py", line 1258, in _prepare_inputs
    generation_batch = self._generate_and_score_completions(generation_batch)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/trl/trainer/grpo_trainer.py", line 1674, in _generate_and_score_completions
    rewards_per_func = self._calculate_rewards(inputs, original_prompts, completions, completion_ids_list)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/trl/extras/profiling.py", line 98, in wrapper
    return func(self, *args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/trl/trainer/grpo_trainer.py", line 1300, in _calculate_rewards
    output_reward_func = reward_func(
  File "/home/jiyoon/LViton_GRPO/utils/utils.py", line 175, in f
    raw = reward_callable(completions, **kw)
  File "/home/jiyoon/LViton_GRPO/utils/utils.py", line 204, in __call__
    "sample_completion_html": wandb.Html(f"<pre>{escape(completions[0])}</pre>")
NameError: name 'escape' is not defined
Traceback (most recent call last):
  File "/home/jiyoon/LViton_GRPO/train.py", line 128, in <module>
    trainer.train()
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/trainer.py", line 2238, in train
    return inner_training_loop(
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/trainer.py", line 2582, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/trainer.py", line 3790, in training_step
    inputs = self._prepare_inputs(inputs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/trl/extras/profiling.py", line 98, in wrapper
    return func(self, *args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/trl/trainer/grpo_trainer.py", line 1258, in _prepare_inputs
    generation_batch = self._generate_and_score_completions(generation_batch)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/trl/trainer/grpo_trainer.py", line 1674, in _generate_and_score_completions
    rewards_per_func = self._calculate_rewards(inputs, original_prompts, completions, completion_ids_list)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/trl/extras/profiling.py", line 98, in wrapper
    return func(self, *args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/trl/trainer/grpo_trainer.py", line 1300, in _calculate_rewards
    output_reward_func = reward_func(
  File "/home/jiyoon/LViton_GRPO/utils/utils.py", line 175, in f
    raw = reward_callable(completions, **kw)
  File "/home/jiyoon/LViton_GRPO/utils/utils.py", line 204, in __call__
    "sample_completion_html": wandb.Html(f"<pre>{escape(completions[0])}</pre>")
NameError: name 'escape' is not defined
