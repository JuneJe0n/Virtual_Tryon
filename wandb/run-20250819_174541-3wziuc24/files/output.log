You have video processor config saved in `preprocessor.json` file which is deprecated. Video processor configs should be saved in their own `video_preprocessor.json` file. You can rename the file or load and save the processor back which renames it automatically. Loading from `preprocessor.json` will be removed in v5.0.
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.09it/s]
trainable params: 1,843,200 || all params: 3,756,466,176 || trainable%: 0.0491
  0%|                                                                                                   | 0/4750 [00:00<?, ?it/s]/home/jiyoon/.local/lib/python3.10/site-packages/torch/utils/checkpoint.py:92: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
Warning: Could not save completions to /home/jiyoon/data/jsonl/completions/run_0.jsonl: Object of type PngImageFile is not JSON serializable
  warnings.warn(
/home/jiyoon/.local/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
  0%|                                                                                        | 2/4750 [00:45<28:34:44, 21.67s/it]Traceback (most recent call last):
Warning: Could not save completions to /home/jiyoon/data/jsonl/completions/run_0.jsonl: Object of type PngImageFile is not JSON serializable
Warning: Could not save completions to /home/jiyoon/data/jsonl/completions/run_0.jsonl: Object of type PngImageFile is not JSON serializable
  File "/home/jiyoon/LViton_GRPO/train.py", line 133, in <module>
    trainer.train()
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/trainer.py", line 2238, in train
    return inner_training_loop(
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/trainer.py", line 2582, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/trainer.py", line 3796, in training_step
    loss = self.compute_loss(model, inputs, num_items_in_batch=num_items_in_batch)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/trl/extras/profiling.py", line 98, in wrapper
    return func(self, *args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/trl/trainer/grpo_trainer.py", line 1813, in compute_loss
    return self._compute_loss(model, inputs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/trl/trainer/grpo_trainer.py", line 1824, in _compute_loss
    per_token_logps, entropies = self._get_per_token_logps_and_entropies(
  File "/home/jiyoon/.local/lib/python3.10/site-packages/trl/extras/profiling.py", line 98, in wrapper
    return func(self, *args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/trl/trainer/grpo_trainer.py", line 1091, in _get_per_token_logps_and_entropies
    logits = model(**model_inputs).logits
  File "/home/jiyoon/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/accelerate/utils/operations.py", line 818, in forward
    return model_forward(*args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/accelerate/utils/operations.py", line 806, in __call__
    return convert_to_fp32(self.model_forward(*args, **kwargs))
  File "/home/jiyoon/.local/lib/python3.10/site-packages/torch/amp/autocast_mode.py", line 43, in decorate_autocast
    return func(*args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/peft/peft_model.py", line 1850, in forward
    return self.base_model(
  File "/home/jiyoon/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/peft/tuners/tuners_utils.py", line 222, in forward
    return self.model.forward(*args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/utils/generic.py", line 959, in wrapper
    output = func(self, *args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/models/qwen2_5_vl/modeling_qwen2_5_vl.py", line 1493, in forward
    outputs = self.model(
  File "/home/jiyoon/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/models/qwen2_5_vl/modeling_qwen2_5_vl.py", line 1277, in forward
    image_mask, _ = self.get_placeholder_mask(
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/models/qwen2_5_vl/modeling_qwen2_5_vl.py", line 1214, in get_placeholder_mask
    special_image_mask = input_ids == self.config.image_token_id
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/configuration_utils.py", line 209, in __getattribute__
    if key != "attribute_map" and key in super().__getattribute__("attribute_map"):
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/jiyoon/LViton_GRPO/train.py", line 133, in <module>
    trainer.train()
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/trainer.py", line 2238, in train
    return inner_training_loop(
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/trainer.py", line 2582, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/trainer.py", line 3796, in training_step
    loss = self.compute_loss(model, inputs, num_items_in_batch=num_items_in_batch)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/trl/extras/profiling.py", line 98, in wrapper
    return func(self, *args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/trl/trainer/grpo_trainer.py", line 1813, in compute_loss
    return self._compute_loss(model, inputs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/trl/trainer/grpo_trainer.py", line 1824, in _compute_loss
    per_token_logps, entropies = self._get_per_token_logps_and_entropies(
  File "/home/jiyoon/.local/lib/python3.10/site-packages/trl/extras/profiling.py", line 98, in wrapper
    return func(self, *args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/trl/trainer/grpo_trainer.py", line 1091, in _get_per_token_logps_and_entropies
    logits = model(**model_inputs).logits
  File "/home/jiyoon/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/accelerate/utils/operations.py", line 818, in forward
    return model_forward(*args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/accelerate/utils/operations.py", line 806, in __call__
    return convert_to_fp32(self.model_forward(*args, **kwargs))
  File "/home/jiyoon/.local/lib/python3.10/site-packages/torch/amp/autocast_mode.py", line 43, in decorate_autocast
    return func(*args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/peft/peft_model.py", line 1850, in forward
    return self.base_model(
  File "/home/jiyoon/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/peft/tuners/tuners_utils.py", line 222, in forward
    return self.model.forward(*args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/utils/generic.py", line 959, in wrapper
    output = func(self, *args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/models/qwen2_5_vl/modeling_qwen2_5_vl.py", line 1493, in forward
    outputs = self.model(
  File "/home/jiyoon/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/models/qwen2_5_vl/modeling_qwen2_5_vl.py", line 1277, in forward
    image_mask, _ = self.get_placeholder_mask(
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/models/qwen2_5_vl/modeling_qwen2_5_vl.py", line 1214, in get_placeholder_mask
    special_image_mask = input_ids == self.config.image_token_id
  File "/home/jiyoon/.local/lib/python3.10/site-packages/transformers/configuration_utils.py", line 209, in __getattribute__
    if key != "attribute_map" and key in super().__getattribute__("attribute_map"):
KeyboardInterrupt
